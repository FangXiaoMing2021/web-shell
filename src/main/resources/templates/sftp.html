<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>web sftp</title>
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/>
    <link rel="shortcut icon" th:href="@{/static/img/favicon.ico}"/>
<!--    <link rel="stylesheet" th:href="@{/static/css/webShell.css}"/>-->
    <link rel="stylesheet" th:href="@{/static/css/jstree/style.min.css}"/>
    <script type="text/javascript" th:src="@{/static/js/jquery-3.5.1.min.js}"></script>
    <script type="text/javascript" th:src="@{/static/js/web-socket.js}"></script>
    <script type="text/javascript" th:src="@{/static/js/web-shell.js}"></script>
    <script type="text/javascript" th:src="@{/static/js/jstree.min.js}"></script>
</head>
<body>
    <div id="jstree_linux_div" class="indexContainer"></div>
</body>
<script th:inline="javascript">
$(function () {
    let url = window.location.href;
    let urlParams = window.location.search;
    history.replaceState(null, null, url.replace(urlParams, ""))
    const params = [[${params}]];
    if (!params) {
        alert("请重新连接SFTP服务！")
    }
    console.log(params);
    let client = new WebSocketClient();
    client.connect({
        onError: function (error) {
            //连接失败回调
            console.error(error)
            alert(error)
        },
        onConnect: function () {
            //连接主机SFTP
            client.sendInitData(params);
        },
        onClose: function () {
            //连接关闭回调
        },
        onData: function (data) {
            //收到数据时回调
            console.log(data)
        }
    });
    $.jstree.defaults.core.themes.variant = "large";
    $('#jstree_linux_div').jstree();
});
</script>
</html>
